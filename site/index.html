<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="./img/favicon.ico">

	<title>Veritrans - Java Client Documentation</title>

        <link href="./css/bootstrap.min.css" rel="stylesheet">
        <link href="./css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="./css/dropdown.css" rel="stylesheet" >
        <link href="./css/github.css" rel="stylesheet">
        <link href="./css/new.css" rel="stylesheet">
        <link href="./css/style.css" rel="stylesheet">
        <link href="./css/vt.css" rel="stylesheet">
        <link href="./css/additional.css" rel="stylesheet">
        <link href="./css/highlight.css" rel="stylesheet">
        <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600' rel='stylesheet' type='text/css'>

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="index.html"> <!-- Veritrans - Java Client Documentation --> <br/></a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li class="active">
                    <a href="index.html">Home</a>
                </li>
            
            
            
                <li >
                    <a href="javadoc/index.html">Javadoc</a>
                </li>
            
            
            
                <li >
                    <a href="sequence_diagram/index.html">Sequence Diagram</a>
                </li>
            
            
            
                <li >
                    <a href="sample_app/index.html">Sample App</a>
                </li>
            
            
            
                <li >
                    <a href="release_notes/index.html">Release Notes</a>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->

            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#veritrans-java-client-documentation">Veritrans - Java Client Documentation</a></li>
        
    
        <li class="main "><a href="#installation">Installation</a></li>
        
            <li><a href="#maven">Maven</a></li>
        
            <li><a href="#gradle">Gradle</a></li>
        
            <li><a href="#jar-library">Jar Library</a></li>
        
    
        <li class="main "><a href="#usage">Usage</a></li>
        
            <li><a href="#vtgatewayconfig">VtGatewayConfig</a></li>
        
            <li><a href="#vtgatewayfactory">VtGatewayFactory</a></li>
        
            <li><a href="#vtdirect">VtDirect</a></li>
        
            <li><a href="#vtweb">VtWeb</a></li>
        
            <li><a href="#other-features">Other Features</a></li>
        
            <li><a href="#status-code-response">Status Code (Response)</a></li>
        
            <li><a href="#notification-handler-notification-url">Notification Handler (Notification URL)</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<p><br/></p>
<p><a href="https://bintray.com/pt-midtrans/maven/veritrans-java-client/_latestVersion"> <img alt="Download" src="https://api.bintray.com/packages/pt-midtrans/maven/veritrans-java-client/images/download.svg" /> </a></p>
<h1 id="veritrans-java-client-documentation">Veritrans - Java Client Documentation</h1>
<p>This is the official Java Client for Veritrans Payment API.  </p>
<p>Please visit <a href="https://www.veritrans.co.id">https://www.veritrans.co.id</a> for more information about the products and see the documentations at <a href="http://docs.veritrans.co.id">http://docs.veritrans.co.id</a> for more technical details. We also have a few <a href="./sequence_diagram/index.html">sequence diagrams</a> which can help you to understands the big picture of our various payment methods process flow.</p>
<hr />
<h1 id="installation">Installation</h1>
<h2 id="maven">Maven</h2>
<p>If you're using Maven as the build tools for your project, please add <strong><a href="https://bintray.com/bintray/jcenter">jcenter</a></strong> repository to your build definition, then add the following dependency to your project's build definition (pom.xml):</p>
<pre><code class="xml">&lt;repositories&gt;
    &lt;repository&gt;
        &lt;id&gt;jcenter&lt;/id&gt;
        &lt;name&gt;bintray&lt;/name&gt;
        &lt;url&gt;http://jcenter.bintray.com&lt;/url&gt;
    &lt;/repository&gt;
&lt;/repositories&gt;

&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;id.co.veritrans&lt;/groupId&gt;
        &lt;artifactId&gt;vt-java-client&lt;/artifactId&gt;
        &lt;version&gt;1.0.3&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre>

<h2 id="gradle">Gradle</h2>
<p>If you're using Gradle as the build tools for your project, please add <strong><a href="https://bintray.com/bintray/jcenter">jcenter</a></strong> repository to your build script then add the following dependency to your project's build definition (build.gradle):</p>
<pre><code class="groovy">repositories {
    maven {
        url  &quot;http://jcenter.bintray.com&quot; 
    }
}

dependencies {
    compile 'id.co.veritrans:vt-java-client:1.0.3'
}
</code></pre>

<h2 id="jar-library">Jar Library</h2>
<p>If you want to download veritrans java-client jar library on your own, you can download it directly <strong><a href="https://bintray.com/artifact/download/pt-midtrans/maven/id/co/veritrans/vt-java-client/1.0.3/vt-java-client-1.0.3-all.jar">here</a></strong></p>
<h1 id="usage">Usage</h1>
<h2 id="vtgatewayconfig">VtGatewayConfig</h2>
<p>VtGatewayConfig stores the settings that is needed by the Veritrans-Java Client to properly accessing the Veritrans Payment API.
Please note that every classes related with VtGatewayConfig is <code>immutable</code> by design. However a builder class is provided to aid the object creation.  </p>
<p>See <a href="./javadoc/id/co/veritrans/mdk/v1/VtGatewayConfig.html">VtGatewayConfig Javadoc</a>.
See <a href="./javadoc/id/co/veritrans/mdk/v1/VtGatewayConfigBuilder.html">VtGatewayConfigBuilder Javadoc</a>.
See <a href="./javadoc/id/co/veritrans/mdk/v1/config/package-summary.html">id.co.veritrans.mdk.v1.config Javadoc</a></p>
<h3 id="server-client-key">Server &amp; Client Key</h3>
<p>You must set the <code>Server Key</code> and <code>Client Key</code> as defined in your <a href="https://my.sandbox.veritrans.co.id/login">Merchant Administration Portal (MAP)</a>.</p>
<pre><code class="java">VtGatewayConfigBuilder vtGatewayConfigBuilder = new VtGatewayConfigBuilder();
vtGatewayConfigBuilder.setServerKey(&quot;Your Server Key&quot;);
vtGatewayConfigBuilder.setClientKey(&quot;Your Client Key&quot;);
</code></pre>

<h3 id="environment">Environment</h3>
<p>You can choose to use Sandbox or Production environment. During development &amp; testing, you might want to set it to Sandbox and use the Production environment when you're ready to go live.  </p>
<p>See <a href="./javadoc/id/co/veritrans/mdk/v1/config/EnvironmentType.html">EnvironmentType Javadoc</a>.</p>
<pre><code class="java">// config for sandbox environment
vtGatewayConfigBuilder.setEnvironmentType(EnvironmentType.SANDBOX);

// config for production environment
vtGatewayConfigBuilder.setEnvironmentType(EnvironmentType.PRODUCTION);
</code></pre>

<p><br/></p>
<h4 id="connection-pool-size">Connection Pool Size</h4>
<p>Veritrans-Java Client is designed to use a HTTP Connection Pool to maintain it's HTTP Connection to Veritrans Server, thus we can take benefit from the
HTTP Keep Alive feature and reuse the connection. In order to support this functionality, a connection pool size need to be set explicitly,
to accomodate the needs of every different companies.<br />
We recommend to set <code>maximum HTTP Connection Pool Size to 16</code>, however it is up to you to set it to a lower or higher value. Do remember that a too low or too high
value <strong><code>could degrade the system performance</code></strong>.</p>
<pre><code class="java">httpConfigBuilder.setMaxConnectionPoolSize(16);
vtGatewayConfigBuilder.setHttpConfig(httpConfigBuilder.createHttpConfig());
</code></pre>

<p><br/></p>
<h4 id="proxy-configuration">Proxy Configuration</h4>
<p>You can setup proxy configuration if you need connect to Veritrans Payment API through proxy server.<br />
See <a href="./javadoc/id/co/veritrans/mdk/v1/config/ProxyConfig.html">ProxyConfig Javadoc</a><br />
See <a href="./javadoc/id/co/veritrans/mdk/v1/config/ProxyConfigBuilder.html">ProxyConfigBuilder Javadoc</a></p>
<pre><code class="java">// this demonstrate configuring proxy settings using method chaining from the builder class
ProxyConfigBuilder proxyConfigBuilder = new ProxyConfigBuilder();

vtGatewayConfigBuilder.setHttpConfig(
    httpConfigBuilder.setProxyConfig(
        proxyConfigBuilder.setHost(&quot;proxy host address&quot;)
            .setPort(12345)
            .setUsername(&quot;proxy username or null&quot;)
            .setPassword(&quot;proxy password or null&quot;)
            .createProxyConfig()
    ).createHttpConfig()
);
</code></pre>

<pre><code class="java">// this demonstrate configuring proxy settings without method chaining
ProxyConfigBuilder proxyConfigBuilder = new ProxyConfigBuilder();

proxyConfigBuilder.setHost(&quot;proxy host address&quot;);
proxyConfigBuilder.setPort(12345);
proxyConfigBuilder.setUsername(&quot;proxy username or null&quot;);
proxyConfigBuilder.setPassword(&quot;proxy password or null&quot;);

ProxyConfig proxyConfig = proxyConfigBuilder.createProxyConfig();
HttpConfig httpConfig = httpConfigBuilder.setProxyConfig(proxyConfig).createHttpConfig();

vtGatewayConfigBuilder.setHttpConfig(httpConfig);
</code></pre>

<p><br/></p>
<h2 id="vtgatewayfactory">VtGatewayFactory</h2>
<p>VtGatewayFactory is a factory class which is used to obtain a reference to various Veritrans Product interface instance, eg: VtDirect instance. This class is also responsible as a manager for every Veritrans Product interface instance returned by the instance of this class. Normally you will make a <code>single instance of VtGatewayFactory class</code> and <code>maintain the reference</code> to this instance, then use it whenever you need to obtain a reference to a Veritrans Product interface. Some instance of Veritrans Product interface instance returned by this class maybe safe to be cached, such as: VtDirect and VtWeb.  </p>
<p>If you need to have multiple VtGatewayFactory with different configuration profiles, consider to make a <code>VtGatewayFactory instance for each configuration profile</code> and reuse that VtGatewayFactory instance to obtain reference to Veritrans Product interface instances.<br />
See <a href="./javadoc/id/co/veritrans/mdk/v1/VtGatewayFactory.html">VtGatewayFactory Javadoc</a>  </p>
<p>Example code to build a VtGatewayFactory:</p>
<pre><code class="java">VtGatewayConfig vtGatewayConfig = vtGatewayConfigBuilder.createVtGatewayConfig();
VtGatewayFactory vtGatewayFactory = new VtGatewayFactory(vtGatewayConfig);
</code></pre>

<p><br/></p>
<h2 id="vtdirect">VtDirect</h2>
<p>VtDirect is an interface class, where it's instance can be used to communicate with Veritrans Payment API. VtDirect instance is safe to share with multiple threads, hence you can safely cache the instance of this class and reuse it multiple times.  </p>
<p>See <a href="./javadoc/id/co/veritrans/mdk/v1/gateway/VtDirect.html">VtDirect Javadoc</a>.<br />
Example code to obtain reference to VtDirect instance:</p>
<pre><code class="java">VtDirect vtDirect = vtGatewayFactory.vtDirect();
</code></pre>

<h3 id="charging-a-transaction">Charging a transaction</h3>
<p>VtDirect has method named <code>charge</code> which takes an instance of VtDirectChargeRequest subclass as the parameter.
This method will make a charge request to Veritrans Payment API and return a VtResponse as a result, which can be used to determine the status of the transaction.  </p>
<p>See <a href="./javadoc/id/co/veritrans/mdk/v1/gateway/model/vtdirect/VtDirectChargeRequest.html">VtDirectChargeRequest</a><br />
See <a href="./javadoc/id/co/veritrans/mdk/v1/gateway/model/VtResponse.html">VtResponse</a><br />
Visit <a href="http://docs.veritrans.co.id/en/api/methods.html#Charge">http://docs.veritrans.co.id/en/api/methods.html#Charge </a>for more information.</p>
<h4 id="vtdirectchargerequest">VtDirectChargeRequest</h4>
<p>VtDirectChargeRequest has specific subclass for a specific payment method, ex: for Credit Card payment method, there is a subclass named CreditCardRequest. The list of currently supported payment methods:  </p>
<ul>
<li><a href="./javadoc/id/co/veritrans/mdk/v1/gateway/model/vtdirect/BankTransferRequest.html">BankTransferRequest</a>  </li>
<li><a href="./javadoc/id/co/veritrans/mdk/v1/gateway/model/vtdirect/BriEpayRequest.html">BriEpayRequest</a>  </li>
<li><a href="./javadoc/id/co/veritrans/mdk/v1/gateway/model/vtdirect/CimbClicksRequest.html">CimbClicksRequest</a>  </li>
<li><a href="./javadoc/id/co/veritrans/mdk/v1/gateway/model/vtdirect/CreditCardRequest.html">CreditCardRequest</a>  </li>
<li><a href="./javadoc/id/co/veritrans/mdk/v1/gateway/model/vtdirect/MandiriClickpayRequest.html">MandiriClickpayRequest</a>  </li>
<li><a href="./javadoc/id/co/veritrans/mdk/v1/gateway/model/vtdirect/BcaKlikpayRequest.html">BcaKlikpayRequest</a>  </li>
<li><a href="./javadoc/id/co/veritrans/mdk/v1/gateway/model/vtdirect/KlikBcaRequest.html">KlikBcaRequest</a></li>
</ul>
<p>See <a href="./javadoc/id/co/veritrans/mdk/v1/gateway/model/package-summary.html">id.co.veritrans.mdk.gateway.model Javadoc</a><br />
See <a href="./javadoc/id/co/veritrans/mdk/v1/gateway/model/vtdirect/package-summary.html">id.co.veritrans.mdk.gateway.model.vtdirect Javadoc</a></p>
<p>It is recommended to have a single method to configure the generic VtDirectChargeRequest values. Example for Credit Card charge:</p>
<pre><code class="java">...
// somewhere in the code
CreditCardRequest vtDirectChargeRequest = new CreditCardRequest();
setVtDirectChargeRequestValues(vtDirectChargeRequest);
// continue processing
...

/**
 * This method is just for example.
 * The actual values should be obtained from another sources.
 */
public void setVtDirectChargeRequestValues(VtDirectChargeRequest vtDirectChargeRequest) {
    vtDirectChargeRequest.setTransactionDetails(new TransactionDetails());
    vtDirectChargeRequest.setCustomerDetails(new CustomerDetails());

    vtDirectChargeRequest.getTransactionDetails().setOrderId(&quot;your unique order ID&quot;);
    vtDirectChargeRequest.getTransactionDetails().setGrossAmount(10000l);

    vtDirectChargeRequest.getCustomerDetails().setEmail(&quot;user@domain.com&quot;);
    vtDirectChargeRequest.getCustomerDetails().setFirstName(&quot;firstName&quot;);
    vtDirectChargeRequest.getCustomerDetails().setPhone(&quot;0123456789&quot;);
    vtDirectChargeRequest.getCustomerDetails().setBillingAddress(new Address());

    Address billingAddress = vtDirectChargeRequest.getCustomerDetails().getBillingAddress();
    billingAddress.setAddress(&quot;Random Street 6A&quot;);
    billingAddress.setCity(&quot;Jakarta Pusat&quot;);
    billingAddress.setPostalCode(&quot;12210&quot;);
}
</code></pre>

<p><br/></p>
<h4 id="bank-transfer">Bank Transfer</h4>
<p>See <a href="./javadoc/id/co/veritrans/mdk/v1/gateway/model/vtdirect/paymentmethod/BankTransfer.html">BankTransfer Javadoc</a><br />
See <a href="./sequence_diagram/index.html#process-flow-for-charging-via-bank-transfer">Bank Transfer Process Flow</a></p>
<pre><code class="java">BankTransferRequest vtDirectChargeRequest = new BankTransferRequest();
setVtDirectChargeRequestValues(vtDirectChargeRequest);
vtDirectChargeRequest.setBankTransfer(new BankTransfer());

vtDirectChargeRequest.getBankTransfer().setBank(BankTransfer.Bank.PERMATA);

VtResponse vtResponse = vtDirect.charge(vtDirectChargeRequest);

if (vtResponse.getStatusCode().equals(&quot;200&quot;) &amp;&amp;
    vtResponse.getTransactionStatus() == TransactionStatus.PENDING) {

    // handle successful Bank Transfer charge request
    // check the permataVaNumber in the vtResponse
} else {
    // handle denied / unexpected response
}
</code></pre>

<p><br/></p>
<h4 id="bri-epay">Bri Epay</h4>
<pre><code class="java">BriEpayRequest vtDirectChargeRequest = new BriEpayRequest();
setVtDirectChargeRequestValues(vtDirectChargeRequest);

VtResponse vtResponse = vtDirect.charge(vtDirectChargeRequest);

if (vtResponse.getStatusCode().equals(&quot;200&quot;) &amp;&amp;
    vtResponse.getTransactionStatus() == TransactionStatus.PENDING) {

    // handle successful Bank Transfer charge request
    // check the redirectUrl value in the vtResponse (redirect the customer to the redirectUrl to continue the payment process)
} else {
    // handle denied / unexpected response
}
</code></pre>

<p><br/></p>
<h4 id="cimb-clicks">Cimb Clicks</h4>
<p>See <a href="./javadoc/id/co/veritrans/mdk/v1/gateway/model/vtdirect/paymentmethod/CimbClicks.html">CimbClicks Javadoc</a></p>
<pre><code class="java">CimbClicksRequest vtDirectChargeRequest = new CimbClicksRequest();
setVtDirectChargeRequestValues(vtDirectChargeRequest);
vtDirectChargeRequest.setCimbClicks(new CimbClicks());

vtDirectChargeRequest.getCimbClicks().setDescription(&quot;Payment for Merchant XYZ&quot;);

VtResponse vtResponse = vtDirect.charge(vtDirectChargeRequest);

if (vtResponse.getStatusCode().equals(&quot;200&quot;) &amp;&amp;
    vtResponse.getTransactionStatus() == TransactionStatus.PENDING) {

    // handle successful Cimb Clicks charge request
    // check the redirectUrl value in the vtResponse (redirect the customer to the redirectUrl to continue the payment process)
} else {
    // handle denied / unexpected response
}
</code></pre>

<p><br/></p>
<h4 id="credit-card-sale">Credit Card Sale</h4>
<p>See <a href="./javadoc/id/co/veritrans/mdk/v1/gateway/model/vtdirect/paymentmethod/CreditCard.html">CreditCard Javadoc</a><br />
See <a href="./sequence_diagram/index.html#credit-card-charging-without-3d-secure-authentication">CreditCard Process Flow Without 3D Secure Authentication</a><br />
See <a href="./sequence_diagram/index.html#credit-card-charging-with-3d-secure-authentication">CreditCard Process Flow With 3D Secure Authentication</a>  </p>
<p><strong>Every Credit Card transaction must use a <code>Token</code> generated by Veritrans Payment API instead of using plain card number.</strong> Please visit <a href="http://docs.veritrans.co.id/vtdirect/integration_cc.html#step1">Acquiring Credit Card Token</a> for further information.</p>
<pre><code class="java">CreditCardRequest vtDirectChargeRequest = new CreditCardRequest();
setVtDirectChargeRequestValues(vtDirectChargeRequest);

CreditCard creditCard = new CreditCardBuilder()
    .setTokenId(&quot;creditCardToken&quot;)          // token is obtained from HTTP POST variable.
    .setAcquirerBank(CreditCard.Bank.BNI)   // your acquirer bank for Credit Card
    .setFraudSector(&quot;fraud sector&quot;)         // merchant fraud sector (applicable only for several merchant) 
    .createCreditCard(); 

vtDirectChargeRequest.setCreditCard(creditCard);

VtResponse vtResponse = vtDirect.charge(vtDirectChargeRequest);

if (vtResponse.getStatusCode().equals(&quot;200&quot;) &amp;&amp;
    vtResponse.getTransactionStatus() == TransactionStatus.CAPTURED &amp;&amp;
    vtResponse.getFraudStatus() == FraudStatus.ACCEPTED) {

    // handle successful capture
} else if (vtResponse.getStatusCode().equals(&quot;201&quot;) &amp;&amp;
    vtResponse.getTransactionStatus() == TransactionStatus.CAPTURED &amp;&amp;
    vtResponse.getFraudStatus() == FraudStatus.CHALLENGE) {

    // handle FDS challenge (you can do this later)
} else {
    // handle denied / unexpected response
}
</code></pre>

<p><br/></p>
<h4 id="credit-card-feature">Credit Card Feature</h4>
<h5 id="pre-authorization">Pre-authorization</h5>
<p>See <a href="./javadoc/id/co/veritrans/mdk/v1/gateway/model/vtdirect/paymentmethod/CreditCard.html">CreditCard Javadoc</a><br />
See <a href="./sequence_diagram/index.html#credit-card-charging-without-3d-secure-authentication">CreditCard Process Flow Without 3D Secure Authentication</a><br />
See <a href="./sequence_diagram/index.html#credit-card-charging-with-3d-secure-authentication">CreditCard Process Flow With 3D Secure Authentication</a>  </p>
<p><strong>Every Credit Card transaction must use a <code>Token</code> generated by Veritrans Payment API instead of using plain card number.</strong> Please visit <a href="http://docs.veritrans.co.id/vtdirect/integration_cc.html#step1">Acquiring Credit Card Token</a> for further information.</p>
<pre><code class="java">CreditCardRequest vtDirectChargeRequest = new CreditCardRequest();
setVtDirectChargeRequestValues(vtDirectChargeRequest);

CreditCard creditCard = new CreditCardBuilder()
    .setTokenId(&quot;creditCardToken&quot;)                  // token is obtained from HTTP POST variable.
    .setAcquirerBank(CreditCard.Bank.BNI)           // your acquirer bank for Credit Card
    .setType(CreditCard.TransactionType.AUTHORIZE)  // pre-authorization transaction type
    .createCreditCard(); 
vtDirectChargeRequest.setCreditCard(creditCard);

VtResponse vtResponseAuthorize = vtDirect.charge(vtDirectChargeRequest);

if (vtResponseAuthorize.getStatusCode().equals(&quot;200&quot;) &amp;&amp;
    vtResponseAuthorize.getTransactionStatus() == TransactionStatus.AUTHORIZED &amp;&amp;
    vtResponseAuthorize.getFraudStatus() == FraudStatus.ACCEPTED) {

    // handle successful capture
} else if (vtResponseAuthorize.getStatusCode().equals(&quot;201&quot;) &amp;&amp;
    vtResponseAuthorize.getTransactionStatus() == TransactionStatus.AUTHORIZED &amp;&amp;
    vtResponseAuthorize.getFraudStatus() == FraudStatus.CHALLENGE) {

    // handle FDS challenge (you can do this later)
} else {
    // handle denied / unexpected response
}
</code></pre>

<h5 id="capture">Capture</h5>
<p>Authorized Credit Card charge request can be captured eventhough the FDS status is <code>CHALLENGE</code>, however the transaction won't be settled unless the transaction is approved using the <a href="#credit-card-accept-an-fds-challenge-capture">Credit Card: Accept an FDS challenge capture</a> feature.</p>
<pre><code class="java">String transactionId = vtResponseAuthorize.getTransactionId();
Long captureAmount = vtResponseAuthorize.getGrossAmount().longValue();
VtResponse vtResponseCapture = vtDirect.capture(transactionId, captureAmount);

if (vtResponseCapture.getStatusCode().equals(&quot;200&quot;) &amp;&amp;
    vtResponseCapture.getTransactionStatus() == TransactionStatus.CAPTURED) {

    // handle successful capture
} else {
    // handle denied / unexpected response
}
</code></pre>

<h5 id="charging-full-pan-coming-soon">Charging Full PAN <strong><em><code>Coming soon</code></em></strong></h5>
<p><strong><em><code>Only allowed for certain merchant</code></em></strong><br />
For PCIDSS compliance merchant, it will be able to charge credit card transaction using customer credit card data instead of using token.</p>
<p><br/></p>
<h4 id="mandiri-clickpay">Mandiri Clickpay</h4>
<p>See <a href="./javadoc/id/co/veritrans/mdk/v1/gateway/model/vtdirect/paymentmethod/MandiriClickpay.html">MandiriClickpay Javadoc</a><br />
Visit <a href="http://docs.veritrans.co.id/sandbox/charge.html#vtdirect-mandiri">Veritrans Mandiri Clickpay Documentation</a> for more information.</p>
<pre><code class="java">MandiriClickpayRequest vtDirectChargeRequest = new MandiriClickpayRequest();
setVtDirectChargeRequestValues(vtDirectChargeRequest);
vtDirectChargeRequest.setMandiriClickpay(new MandiriClickpay());

vtDirectChargeRequest.getMandiriClickpay().setCardNumber(&quot;4111111111111111&quot;);
vtDirectChargeRequest.getMandiriClickpay().setInput1(&quot;111111111&quot;);
vtDirectChargeRequest.getMandiriClickpay().setInput2(&quot;10000&quot;);
vtDirectChargeRequest.getMandiriClickpay().setInput3(&quot;54321&quot;);
vtDirectChargeRequest.getMandiriClickpay().setToken(&quot;000000&quot;);

VtResponse vtResponse = vtDirect.charge(vtDirectChargeRequest);

if (vtResponse.getStatusCode().equals(&quot;200&quot;) &amp;&amp;
    vtResponse.getTransactionStatus() == TransactionStatus.SETTLED) {

    // handle successful Mandiri Clickpay charge request
} else {
    // handle denied / unexpected response
}
</code></pre>

<p><br/></p>
<h4 id="bca-klikpay">BCA KlikPay</h4>
<p>See <a href="./javadoc/id/co/veritrans/mdk/v1/gateway/model/vtdirect/paymentmethod/BcaKlikpay.html">BcaKlikpay Javadoc</a>  </p>
<pre><code class="java">BcaKlikpayRequest vtDirectChargeRequest = new BcaKlikpayRequest();
setVtDirectChargeRequestValues(vtDirectChargeRequest);
vtDirectChargeRequest.setBcaKlikpay(new BcaKlikpay());

vtDirectChargeRequest.getBcaKlikpay().setType(1);
vtDirectChargeRequest.getBcaKlikpay().setMiscFee(10000L);
vtDirectChargeRequest.getBcaKlikpay().setDescription(&quot;Product X&quot;);

VtResponse vtResponse = vtDirect.charge(vtDirectChargeRequest);

if (vtResponse.getStatusCode().equals(&quot;200&quot;) &amp;&amp;
    vtResponse.getTransactionStatus() == TransactionStatus.PENDING) {

    // handle successful  BCA Klikpay charge request
    // check the redirectUrl value in the vtResponse (redirect the customer to the redirectUrl to continue the payment process)
} else {
    // handle denied / unexpected response
}
</code></pre>

<p><br/></p>
<h4 id="klik-bca">Klik BCA</h4>
<p>See <a href="./javadoc/id/co/veritrans/mdk/v1/gateway/model/vtdirect/paymentmethod/KlikBca.html">Klik BCA Javadoc</a>  </p>
<pre><code class="java">KlikBcaRequest vtDirectChargeRequest = new KlikBcaRequest();
setVtDirectChargeRequestValues(vtDirectChargeRequest);
vtDirectChargeRequest.setKlikBca(new KlikBca());

vtDirectChargeRequest.getKlikBca().setUserId(&quot;user ID&quot;);
vtDirectChargeRequest.getKlikBca().setDescription(&quot;Transaction description&quot;);

VtResponse vtResponse = vtDirect.charge(vtDirectChargeRequest);

if (vtResponse.getStatusCode().equals(&quot;200&quot;) &amp;&amp;
    vtResponse.getTransactionStatus() == TransactionStatus.PENDING) {

    // handle successful  BCA Klikpay charge request
    // show instruction to customer on how to pay with klikbca
} else {
    // handle denied / unexpected response
}
</code></pre>

<p><br/></p>
<h2 id="vtweb">VtWeb</h2>
<p>VtWeb is an interface class, where it's instance can be used to communicate with Veritrans Payment API, but <strong>VtWeb <code>charge</code> functionality will be responded with redirect url</strong> which is used to redirect customers to Veritrans's Payment Page. VtWeb instance is safe to share with multiple threads, hence you can safely cache the instance of this class and reuse it multiple times.  </p>
<p>See <a href="./javadoc/id/co/veritrans/mdk/v1/gateway/VtWeb.html">VtWeb Javadoc</a>.<br />
Example code to obtain reference to VtWeb instance:</p>
<pre><code class="java">VtWeb vtWeb = vtGatewayFactory.vtWeb();
</code></pre>

<p><br/></p>
<h3 id="charging-a-transaction_1">Charging a transaction</h3>
<pre><code class="java">VtWebChargeRequest vtWebChargeRequest = new VtWebChargeRequest();
setVtWebChargeRequestValues(vtWebChargeRequest);
vtWebChargeRequest.setVtWeb(new VtWebParam());
vtWebChargeRequest.getVtWeb().setCreditCardUse3dSecure(true);

VtResponse vtResponse = vtWeb.charge(vtWebChargeRequest);
if (vtResponse.getStatusCode().equals(&quot;201&quot;)) {
    // Redirect user to redirecturl param [vtResponse.getRedirectUrl()]
} else {
    // Handle denied / unexpected response
}
</code></pre>

<h3 id="set-enabled-payment-method">Set enabled payment method</h3>
<p>You can specify manually on every request which payment method that want to be enabled on transaction.</p>
<pre><code class="java">VtWebChargeRequest vtWebChargeRequest = new VtWebChargeRequest();
setVtWebChargeRequestValues(vtWebChargeRequest);
vtWebChargeRequest.setVtWeb(new VtWebParam());
vtWebChargeRequest.getVtWeb().setEnabledPayments(new VtWebParam.PaymentMethod[]{VtWebParam.PaymentMethod.CREDIT_CARD, VtWebParam.PaymentMethod.CIMB_CLICKS});
</code></pre>

<h3 id="handle-vtweb-url-parameter-response">Handle VtWeb URL parameter response</h3>
<p>After customer finishes transaction on vtWeb page, it will be redirected to merchant web page based on redirect url config that already setup before. Veritrans will response with several url parameter that can be handle by merchant :</p>
<ul>
<li>order_id</li>
<li>status_code</li>
<li>transaction_status</li>
</ul>
<pre><code>&lt;!-- Success transaction example --&gt;
http://www.example.com/finish?order_id=asf1434355961&amp;status_code=200&amp;transaction_status=capture

&lt;!-- Deny transaction example --&gt;
http://www.example.com/deny?order_id=asf1434356038&amp;status_code=202&amp;transaction_status=deny

&lt;!-- Pending transaction example --&gt;
http://www.example.com/pending?order_id=asf1434356096&amp;status_code=201&amp;transaction_status=pending
</code></pre>

<p><br /></p>
<h2 id="other-features">Other Features</h2>
<h3 id="check-transaction-status">Check Transaction Status</h3>
<h4 id="vtdirect_1">VtDirect</h4>
<pre><code class="java">String orderId = &quot;your unique order ID&quot;;
VtResponse vtResponse = vtDirect.status(orderId);
// continue processing based on the vtResponse
</code></pre>

<h4 id="vtweb_1">VtWeb</h4>
<pre><code class="java">String orderId = &quot;your unique order ID&quot;;
VtResponse vtResponse = vtWeb.status(orderId);
// continue processing based on the vtResponse
</code></pre>

<h3 id="check-multiple-transaction-status">Check Multiple Transaction Status</h3>
<pre><code class="java">ArrayList&lt;String&gt; listOrderIds = new ArrayList&lt;String&gt;();
listOrderIds.add(orderId1);
listOrderIds.add(orderId2);

// Build status request from list of order ID
StatusRequest statusRequest = new StatusRequestBuilder()
    .setOrderIds(listOrderIds)
    .setPage(1)
    .setRowPerPage(10)
    .createStatusRequest();

VtResponse vtResponse = vtDirect.status(statusRequest);
</code></pre>

<h3 id="querying-transaction-status">Querying Transaction Status</h3>
<pre><code class="java">// Build get status query parameter
final GetStatusParameter parameter = new GetStatusParameterBuilder()
    .setFraudStatus(FraudStatus.CHALLENGE)
    .setTransactionStatus(TransactionStatus.AUTHORIZED)
    .setPaymentMethod(PaymentMethod.CREDIT_CARD)
    .setPage(2)
    .setRowPerPage(10)
    .createGetStatusParameter();

VtResponse response = vtDirect.queryStatus(parameter);
</code></pre>

<p><br/></p>
<h3 id="credit-card-accept-an-fds-challenge-capture">Credit Card: Accept an <code>FDS challenge</code> capture</h3>
<h4 id="vtdirect_2">VtDirect</h4>
<pre><code class="java">String orderId = &quot;your unique order ID&quot;;
VtResponse vtResponse = vtDirect.approve(orderId);

if (vtResponse.getStatusCode().equals(&quot;200&quot;) &amp;&amp;
    vtResponse.getTransactionStatus() == TransactionStatus.CAPTURED) {

    // handle successful capture approval
} else {
    // handle denied / unexpected response
}
</code></pre>

<h4 id="vtweb_2">VtWeb</h4>
<pre><code class="java">String orderId = &quot;your unique order ID&quot;;
VtResponse vtResponse = vtWeb.approve(orderId);

if (vtResponse.getStatusCode().equals(&quot;200&quot;) &amp;&amp;
    vtResponse.getTransactionStatus() == TransactionStatus.CAPTURED) {

    // handle successful capture approval
} else {
    // handle denied / unexpected response
}
</code></pre>

<p><br/></p>
<h3 id="cancel-transaction">Cancel Transaction</h3>
<h4 id="vtdirect_3">VtDirect</h4>
<pre><code class="java">String orderId = &quot;your unique order ID&quot;;
VtResponse vtResponse = vtDirect.cancel(orderId);

if (vtResponse.getStatusCode().equals(&quot;200&quot;) &amp;&amp;
    vtResponse.getTransactionStatus() == TransactionStatus.CANCELLED) {

    // handle successful transaction cancel
} else {
    // handle denied / unexpected response
}
</code></pre>

<h4 id="vtweb_3">VtWeb</h4>
<pre><code class="java">String orderId = &quot;your unique order ID&quot;;
VtResponse vtResponse = vtWeb.cancel(orderId);

if (vtResponse.getStatusCode().equals(&quot;200&quot;) &amp;&amp;
    vtResponse.getTransactionStatus() == TransactionStatus.CANCELLED) {

    // handle successful transaction cancel
} else {
    // handle denied / unexpected response
}
</code></pre>

<p><br/></p>
<h2 id="status-code-response">Status Code (Response)</h2>
<p>Status Codes used by Veritrans API are categorized into 2xx, 3xx, 4xx dan 5xx. You can check detail of all status code that responded from transaction request in <strong><em><a href="http://docs.veritrans.co.id/en/api/status_code.html">here</a></em></strong></p>
<p><br/></p>
<h2 id="notification-handler-notification-url">Notification Handler (Notification URL)</h2>
<p>Notification URL is used by Veritrans Payment API to notify a merchant once a payment process has been completed or failed.
It is invoked by Veritrans Payment API through HTTP POST by sending a JSON Message in the request body.
The structure of the JSON Message is identical with the JSON Response when invoking the Veritrans Payment API.  </p>
<p>There is a static method provided by VtResponse to help you deserializing the JSON Message into a VtResponse instance.
This method accepts <code>JSON String</code> or a <code>Raw Input Stream</code>.
<strong>Do remember that it is still the caller responsibility to close the InputStream</strong>.</p>
<p>Below is an example code to handle Notification URL using Java Servlet API:</p>
<pre><code class="java">...
void doPost(HttpServletRequest req, HttpServletResponse resp) {
    try {
        ServletInputStream inputStream = req.getInputStream();
        VtResponse vtResponse = VtResponse.deserializeJson(inputStream);

        // if necessary, we can utilize VtDirect's or VtWeb's Check Transaction Status Feature to make sure the notification is really coming from Veritrans
        String orderId = vtResponse.getOrderId();
        vtResponse = vtDirect.status(orderId); // we used VtDirect in this example, however we can use VtWeb too

        if (vtResponse.getTransactionStatus() == TransactionStatus.SETTLED) {
            // handle settled / successful charge request
        } else {
            // handle denied / unexpected response
        }
    } catch (JsonDeserializeException e) {
        // handle JSON deserialization error
        ...
    } finally {
        resp.setStatus(HttpServletResponse.SC_OK);
    }
}
...
</code></pre></div>
        </div>

        <script src="./js/jquery-1.10.2.min.js"></script>
        <script src="./js/bootstrap.min.js"></script>
        <script src="./js/dropdown.js"></script>
        <script src="./js/get-token.js"></script>
        <script src="./js/tab_custom.js"></script>
        <script src="./js/base.js"></script>
        <script src="./js/highlight.pack.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
    </body>
</html>